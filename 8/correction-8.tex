\documentclass{article}
\errorcontextlines 10000

\makeatletter

\usepackage{fontspec}
\usepackage{xunicode}
\usepackage{xltxtra}

\usepackage{fullpage}
\usepackage{mleftright}
\usepackage{hhline}

\usepackage{hyperref}

\hypersetup{%
	linktocpage  = true, %page number is the link (not title)
	colorlinks   = true, %Colours links instead of ugly boxes
	urlcolor     = darkblue, %Colour for external hyperlinks
	linkcolor    = darkblue, %Colour of internal links
	citecolor    = darkblue   %Colour of citations
}

%\hypersetup{
%	linktocpage  = true, %page number is the link (not title)
%	colorlinks   = true, %Colours links instead of ugly boxes
%	allcolors = bookColor,
%	hidelinks = true
%}

% good looking urls
\urlstyle{same}

\newcommand{\theoremname}{Theorem}
\newcommand{\corollaryname}{Corollary}
\newcommand{\problemname}{Problem}
\newcommand{\conjecturename}{Conjecture}
\newcommand{\definitionname}{Definition}

% we use this for our references as well
\let\sref\ref
\AtBeginDocument{\renewcommand{\ref}[1]{\mbox{\autoref{#1}}}}
\usepackage[nameinlink]{cleveref}

% define colors %
\usepackage[table]{xcolor}

%\usepackage[table,dvipdfx,cmyk]{xcolor}
%\definecolor{bookColor}{cmyk}{0 ,0 ,0 ,1}
%\color{bookColor}

\definecolor{lightgray}{rgb}{0.9,0.9,0.9}
\definecolor{darkgray}{rgb}{0.4,0.4,0.4}
\definecolor{purple}{rgb}{0.65, 0.12, 0.82}
\definecolor{darkblue}{rgb}{0.02, 0.17, 0.40}
\usepackage[stable]{footmisc}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{url}
\usepackage{amsmath,amsthm,amsfonts,mathtools}
\usepackage{xfrac}


\newtheorem{theorem}{\theoremname}
\newtheorem{corollary}{\corollaryname}
\newtheorem{problem}{\problemname}
\newtheorem{conjecture}{\conjecturename}
\newtheorem{definition}{\definitionname}

% nicely spaced operators
\DeclareMathOperator{\Exists}{\exists}
\DeclareMathOperator{\Forall}{\forall}

\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\newcommand{\card}[1]{|#1|}

\newcommand{\st}{\colon\,}
\newcommand{\TM}{TM}
\newcommand{\Atm}{A\textsubscript{TM}}
\newcommand{\HALTtm}{HALT\textsubscript{TM}}

\newcommand{\N}{\mathbb{N}}
\newcommand{\nth}[1]{#1^{\text{th}}}

\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=2pt] (char) {#1};}}



% TURING MACHINE DESCRIPTIONS
\usepackage{changepage}
\newenvironment{steps}%
{%
\vspace{0.25cm}%
\begin{adjustwidth}{0.3cm}{0cm}%
\begin{description}%
}
{%
\end{description}%
\end{adjustwidth}%
\vspace{0.1cm}%
}

\newcounter{TMachine}[section]
\renewcommand{\theTMachine}{\thesection.\arabic{TMachine}}%
\newenvironment{TMachine}[1]
  {\refstepcounter{TMachine}%
   \par%
   \vspace{.5\baselineskip\@plus.2\baselineskip\@minus.2\baselineskip}% Space above
   \noindent{#1}%
   \begin{steps}}%\begin{TMachine}
  {\end{steps}%
\vspace{.5\baselineskip\@plus.2\baselineskip\@minus.2\baselineskip}% Space below
}% \end{TMachine}

\newcommand{\accept}{\emph{accept}}
\newcommand{\reject}{\emph{reject}}

\makeatother

\title{Computability and Complexity:\\Exercise Session 8 (2016-11-23)}
\author{Aur√©lien Ooms\footnote{aureooms@ulb.ac.be}}
\date{\today}

\begin{document}
\maketitle
\tableofcontents

\section{CLIQUE, VERTEX-COVER, and INDEPENDENT-SET}

Let us first define the concepts of clique and independent set in a graph.
Given a graph, a clique is a subset of its vertices such that \textbf{each} pair in this
subset is connected by an edge.

\begin{definition}[Clique]
  Let $G=(V,E)$, $S\subseteq V$. The set of vertices $S$ is a clique of $G$
  if and only if for all $(u,v) \in S^2$ with $u\ne v$, $\{\,u,v\,\} \in E$.
\end{definition}

Given a graph, an independent set is a subset of its vertices such that
\textbf{no} pair in this
subset is connected by an edge.
\begin{definition}[Independent set]
  Let $G=(V,E)$, $S\subseteq V$. The set of vertices $S$ is an independent set
  of $G$ if and only if for all $(u,v) \in S^2$ with $u\ne v$, $\{\,u,v\,\} \not\in E$.
\end{definition}

We show that, as you may already have noticed, those two concepts are
closely related. To achieve this goal, let us define the complement of a graph
$G$, $\bar{G}$, that has the same vertex set as $G$, but whose edge set
contains only the edges that are missing in $G$:
\begin{definition}[Complement of a graph]
  Let $G = (V,E)$, define $\bar{E}=\{\,\{\,u,v\,\} \st (u,v) \in S^2,
  u \ne v, \{\,u,v\,\} \not\in E\,\}$ and $\bar{G} = (V,\bar{E})$.
\end{definition}

We are now ready to prove our first result:
\begin{theorem}\label{is-cl}
  Let $G = (V,E)$, $S \subseteq V$. The set $S$ is an independent set in $G$ if
  and only if $S$ is a clique in $\bar{G}$.
\end{theorem}

\begin{proof}
  Let us prove the two directions of the implication.
  \paragraph{($\implies$)}%
  Let $S$ be an independent set in $G$.
  For any $(u,v) \in S^2, u \ne v$, by definition of an independent set,
  $\{\,u,v\,\} \not\in E$, hence, $\{\,u,v\,\} \in \bar{E}$. Hence, by
  definition of a clique, $S$ is a clique in $\bar{G}$.

  \paragraph{($\impliedby$)}%
  Conversely, let $S$ be a clique in $\bar{G}$.
  For any $(u,v) \in S^2, u \ne v$, by definition of a clique,
  $\{\,u,v\,\} \in \bar{E}$, hence, $\{\,u,v\,\} \not\in E$. Hence, by
  definition of an independent set, $S$ is an independent set in $G$.
\end{proof}

We define a third concept, the vertex cover. Given a graph, a vertex cover in
this graph covers all its edges by containing at least one endpoint of each.
\begin{definition}[Vertex cover]
  Let $G=(V,E)$, $S\subseteq V$. The set of vertices $S$ is a vertex cover of
  $G$ if and only if for all $\{u,v\} \in E$, $u \in S \lor v \in S$.
\end{definition}

Again, although maybe less obvious, the concepts of vertex cover and
independent set are closely related.
\begin{theorem}\label{is-vc}
  Let $G = (V,E)$, $S \subseteq V$. The set $S$ is an independent set in $G$ if
  and only if $T = V \setminus S$ is a vertex cover in $G$.
\end{theorem}

\begin{proof}
  Let us prove the two directions of the implication.
  \paragraph{($\implies$)}%
  Let $S$ be an independent set in $G$ and define $T = V \setminus S$.
  For any $\{\,u,v\,\} \in E$, by definition of an independent set, at most one
  of $u$ and $v$ belongs to $S$, hence, at least one of $u$ and $v$ belongs to
  $T$. Hence, by definition of a vertex cover, $T$ is a vertex cover in $G$.

  \paragraph{($\impliedby$)}%
  Conversely, let $T$ be a vertex cover in $G$ and define $S = V \setminus T$.
  For any $\{\,u,v\,\} \in E$, by definition of a vertex cover, at least one
  of $u$ and $v$ belongs to $T$, hence, at most one of $u$ and $v$ belongs to
  $S$. Hence, by definition of an independent set, $S$ is an independent set in
  $G$.
\end{proof}

As an exercise, you can show the following:
\begin{corollary}\label{vc-cl}
  Let $G = (V,E)$, $S \subseteq V$. The set $S$ is an clique in $G$ if
  and only if $T = V \setminus S$ is a vertex cover in $\bar{G}$.
\end{corollary}

We are interested in the complexities of the problems of deciding the existence
of those substructures in arbitrary graphs. We define the following languages:
\begin{definition}
  CLIQUE $= \{\langle G,k \rangle \st \text{$G$ contains a clique of size $k$.} \}$
\end{definition}

\begin{definition}
  INDEPENDENT-SET $= \{\langle G,k \rangle \st \text{$G$ contains an independent set of size $k$.} \}$
\end{definition}

\begin{definition}
  VERTEX-COVER $= \{\langle G,k \rangle \st \text{$G$ contains a vertex-cover of size $k$.} \}$
\end{definition}

During a previous lecture, you proved that CLIQUE is complete for the
complexity class NP. This means that (1) CLIQUE is in NP, that is, it is as
``easy'' as all other problems in NP, and (2), CLIQUE is NP-hard,
that is, it is as ``hard'' as all other problems in NP.
\begin{theorem}\label{cl:npc}
CLIQUE is NP-complete.
\end{theorem}
\begin{proof}
  See lecture notes.
\end{proof}

Building on~\ref{is-cl}~and~\ref{cl:npc}, we can prove the following:
\begin{theorem}\label{is:npc}
INDEPENDENT-SET is NP-complete.
\end{theorem}

\begin{proof}
  We must prove that INDEPENDENT-SET is both in NP and NP-complete.
  \paragraph{$\in$ NP}
  By~\ref{is-cl}, $\langle G,k \rangle \in$ INDEPENDENT-SET if (and only if)
  $\langle \bar{G},k\rangle \in$ CLIQUE.
  In other words, deciding if a graph $G$ contains an independent set of size $k$ is
  equivalent to deciding if the complement of $G$, $\bar{G}$, contains a
  clique of size $k$. The reduction takes quadratic time in the worst
  case where $G$ contains no edge and $\bar{G}$ contains $\binom{\card{V}^2}{2}$.
  By~\ref{cl:npc}, CLIQUE is in NP, that is, ``easy''. Since
  we can solve an instance of INDEPENDENT-SET by solving a polynomial size instance of
  CLIQUE then INDEPENDENT-SET must be as ``easy'' as CLIQUE, that
  is, INDEPENDENT-SET is in NP.

  \paragraph{NP-hard}
  By~\ref{is-cl}, $\langle G,k \rangle \in$ CLIQUE if (and only if)
  $\langle \bar{G},k\rangle \in$ INDEPENDENT-SET.
  In other words, deciding if a graph $G$ contains a clique of size $k$ is
  equivalent to deciding if the complement of $G$, $\bar{G}$, contains an
  independent set of size $k$. The reduction takes quadratic time in the worst
  case where $G$ contains no edge and $\bar{G}$ contains $\binom{\card{V}^2}{2}$.
  By~\ref{cl:npc}, CLIQUE is NP-hard, that is, ``hard''. Since
  we can solve an instance of CLIQUE by solving a polynomial size instance of
  INDEPENDENT-SET then INDEPENDENT-SET must be as ``hard'' as CLIQUE, that
  is, INDEPENDENT-SET is NP-hard.
\end{proof}

Building on~\ref{is-vc}~and~\ref{is:npc}, we can prove the following:
\begin{theorem}\label{vc:npc}
VERTEX-COVER is NP-complete.
\end{theorem}

\begin{proof}
  We must prove that VERTEX-COVER is both in NP and NP-complete.
  \paragraph{$\in$ NP}
  By~\ref{is-vc}, $\langle G,k \rangle \in$ VERTEX-COVER if (and only if)
  $\langle G,\card{V}-k\rangle \in$ INDEPENDENT-SET.
  In other words, deciding if a graph $G$ contains a vertex cover of size $k$ is
  equivalent to deciding if $G$ contains an
  independent set of size $\card{V}-k$. The reduction takes linear time as $G$ stays the
  same and $\card{V}-k$ has bit-size $\lceil\log \card{V} - k\rceil \le
  \max(\log\card{V},\log k) + 1$.
  By~\ref{is:npc}, INDEPENDENT-SET is in NP, that is, ``easy''. Since
  we can solve an instance of VERTEX-COVER by solving a polynomial size instance of
  INDEPENDENT-SET then VERTEX-COVER must be as ``easy'' as INDEPENDENT-SET, that
  is, VERTEX-COVER is in NP.

  \paragraph{NP-hard}
  By~\ref{is-vc}, $\langle G,k \rangle \in$ INDEPENDENT-SET if (and only if)
  $\langle G,\card{V}-k\rangle \in$ VERTEX-COVER.
  In other words, deciding if a graph $G$ contains an independent set of size $k$ is
  equivalent to deciding if $G$ contains a
  vertex cover of size $\card{V}-k$. The reduction takes linear time as $G$ stays the
  same and $\card{V}-k$ has bit-size $\lceil\log \card{V} - k\rceil \le
  \max(\log\card{V},\log k) + 1$.
  By~\ref{is:npc}, INDEPENDENT-SET is NP-hard, that is, ``hard''. Since
  we can solve an instance of INDEPENDENT-SET by solving a polynomial size instance of
  VERTEX-COVER then VERTEX-COVER must be as ``hard'' as INDEPENDENT-SET, that
  is, VERTEX-COVER is NP-hard.
\end{proof}

\section{\texorpdfstring{$\ne$SAT\footnote{%
Exercise 7.26 from the reference book: Sipser M.,
\emph{Introduction to the Theory of Computation}, 3rd edition
(2013).
In the second edition of the book, the exercise is Exercise 7.24.
}}{$\ne$SAT}}

Let us start with a definition:
\begin{definition}
  Let $\phi$ be a 3cnf-formula. An $\ne$-assignment to the variables of $\phi$
  is one where each clause contains two literals with unequal truth values.
\end{definition}
In other words, an $\ne$-assignment satisfies $\phi$ without assigning three
true literals in any clause.

\begin{theorem}\label{neg}
  The negation of any $\ne$-assignment to $\phi$ is also an $\ne$-assignment.
\end{theorem}
\begin{proof}
  An $\ne$-assignment to the variables of $\phi$ is such that each clause
  contains a true and a false literal. Hence, the negation of that
  $\ne$-assignement is such that each clause of $\phi$ contains a false
  and a true literal, that is, it is an $\ne$-assignment.
\end{proof}

Let $\ne$SAT be the collection of 3cnf-formulas that have an $\ne$-assignment.
\begin{definition}
  $\ne$SAT = $\{\,\langle \phi \rangle\st \text{$\phi$ has an $\ne$-assignment.} \,\}$
\end{definition}

We show there is a polynomial time reduction from 3SAT to $\ne$SAT.
\begin{theorem}
  3SAT $\le_P$ $\ne$SAT.
\end{theorem}

\begin{proof}
  Given $\varphi$ a 3cnf-formula, let $\phi$ be the formula where we replace
  each clause $c_i = (x \lor y \lor z)$ of $\varphi$, with the two clauses $(x
  \lor y \lor \alpha_i)$ and $(\bar{\alpha_i} \lor z \lor \beta)$, where $\alpha_i$ is a
  new variable for each clause $c_i$, and $\beta$ is a single additional new
  variable common to every second clause in $\phi$.

  Let us check that $\varphi$ is satisfiable if and only if $\phi$ has an
  $\ne$-assignment.

  \paragraph{($\implies$)} If $\varphi$ is satisfiable, set $\beta=F$, for each
  $c_i$, looking at~\ref{table}, if $x=F$, $y=F$, $z=T$, set $\alpha_i=T$,
  otherwise set $\alpha_i=F$.

  \paragraph{($\impliedby$)}
  If $\phi$ has an $\ne$-assignment, then, by~\ref{neg}, it has an
  $\ne$-assignment with $\beta$ set to false. Looking at the $\ne$-assignments
  with $\beta$ set to false in~\ref{table}, we see that in all cases $\varphi$
  is satisfiable.

\begin{table}
	\centering
	\caption{Truth table for a clause in $\varphi$ and its corresponding clauses in
	$\phi$.}\label{table}
	\begin{tabular}{|c|ccc|c|cc|c|}
	\hline
	& $x$ & $y$ & $z$ & $(x \lor y \lor z)$ & $\alpha_i$ & $\beta$ & $(x \lor
	y \lor \alpha_i) \land (\bar{\alpha_i} \lor z \lor \beta)$ \\
	\hline
	1 & F & F & F & F & F & F & F \\
	2 & F & F & T & T & F & F & F \\
	3 & F & T & F & T & F & F & T \\
	4 & F & T & T & T & F & F & T \\
	5 & T & F & F & T & F & F & T \\
	6 & T & F & T & T & F & F & T \\
	7 & T & T & F & T & F & F & T \\
	8 & T & T & T & T & F & F & T \\
	\hline
	9 & F & F & F & F & T & F & F \\
	10 & F & F & T & T & T & F & T \\
	11 & F & T & F & T & T & F & F \\
	12 & F & T & T & T & T & F & T \\
	13 & T & F & F & T & T & F & F \\
	14 & T & F & T & T & T & F & T \\
	15 & T & T & F & T & T & F & F \\
	16 & T & T & T & T & T & F & F \\
	\hline
	%17 & F & F & F & F & F & T & F \\
	%18 & F & F & T & T & F & T & F \\
	%19 & F & T & F & T & F & T & T \\
	%20 & F & T & T & T & F & T & F \\
	%21 & T & F & F & T & F & T & T \\
	%22 & T & F & T & T & F & T & F \\
	%23 & T & T & F & T & F & T & T \\
	%24 & T & T & T & T & F & T & F \\
	%\hline
	%25 & F & F & F & F & T & T & T \\
	%26 & F & F & T & T & T & T & T \\
	%27 & F & T & F & T & T & T & T \\
	%28 & F & T & T & T & T & T & T \\
	%29 & T & F & F & T & T & T & T \\
	%30 & T & F & T & T & T & T & T \\
	%31 & T & T & F & T & T & T & T \\
	%32 & T & T & T & T & T & T & F \\
	%\hline
\end{tabular}
\end{table}

The reduction takes linear time: $\phi$ is exactly two times longer than $\varphi$.
\end{proof}

Given a 3cnf-formula $\phi$, it is easy to see that an $\ne$-assignment to
$\phi$ is a polynomial size certificate for the belonging of $\phi$ to $\ne$SAT
that can be verified in polynomial time. Hence,
\begin{theorem}
  $\ne$SAT is NP-complete.
\end{theorem}

\end{document}
