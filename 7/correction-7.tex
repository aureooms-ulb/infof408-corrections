\documentclass{article}
\errorcontextlines 10000

\makeatletter

\usepackage{fontspec}
\usepackage{xunicode}
\usepackage{xltxtra}

\usepackage{fullpage}
\usepackage{mleftright}

\usepackage{hyperref}

\hypersetup{%
	linktocpage  = true, %page number is the link (not title)
	colorlinks   = true, %Colours links instead of ugly boxes
	urlcolor     = darkblue, %Colour for external hyperlinks
	linkcolor    = darkblue, %Colour of internal links
	citecolor    = darkblue   %Colour of citations
}

%\hypersetup{
%	linktocpage  = true, %page number is the link (not title)
%	colorlinks   = true, %Colours links instead of ugly boxes
%	allcolors = bookColor,
%	hidelinks = true
%}

% good looking urls
\urlstyle{same}

\newcommand{\theoremname}{Theorem}
\newcommand{\corollaryname}{Corollary}
\newcommand{\problemname}{Problem}
\newcommand{\conjecturename}{Conjecture}
\newcommand{\definitionname}{Definition}

% we use this for our references as well
\let\sref\ref
\AtBeginDocument{\renewcommand{\ref}[1]{\mbox{\autoref{#1}}}}
\usepackage[nameinlink]{cleveref}

% define colors %
\usepackage[table]{xcolor}

%\usepackage[table,dvipdfx,cmyk]{xcolor}
%\definecolor{bookColor}{cmyk}{0 ,0 ,0 ,1}
%\color{bookColor}

\definecolor{lightgray}{rgb}{0.9,0.9,0.9}
\definecolor{darkgray}{rgb}{0.4,0.4,0.4}
\definecolor{purple}{rgb}{0.65, 0.12, 0.82}
\definecolor{darkblue}{rgb}{0.02, 0.17, 0.40}
\usepackage[stable]{footmisc}
\usepackage{graphicx}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\usepackage{url}
\usepackage{amsmath,amsthm,amsfonts,mathtools}
\usepackage{xfrac}


\newtheorem{theorem}{\theoremname}
\newtheorem{corollary}{\corollaryname}
\newtheorem{problem}{\problemname}
\newtheorem{conjecture}{\conjecturename}
\newtheorem{definition}{\definitionname}

% nicely spaced operators
\DeclareMathOperator{\Exists}{\exists}
\DeclareMathOperator{\Forall}{\forall}

\DeclarePairedDelimiter{\ceil}{\lceil}{\rceil}
\newcommand{\card}[1]{|#1|}

\newcommand{\st}{\colon\,}
\newcommand{\TM}{TM}
\newcommand{\Atm}{A\textsubscript{TM}}
\newcommand{\HALTtm}{HALT\textsubscript{TM}}

\newcommand\N{\mathbb{N}_1}

\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=2pt] (char) {#1};}}



% TURING MACHINE DESCRIPTIONS
\usepackage{changepage}
\newenvironment{steps}%
{%
\vspace{0.25cm}%
\begin{adjustwidth}{0.3cm}{0cm}%
\begin{description}%
}
{%
\end{description}%
\end{adjustwidth}%
\vspace{0.1cm}%
}

\newcounter{TMachine}[section]
\renewcommand{\theTMachine}{\thesection.\arabic{TMachine}}%
\newenvironment{TMachine}[1]
  {\refstepcounter{TMachine}%
   \par%
   \vspace{.5\baselineskip\@plus.2\baselineskip\@minus.2\baselineskip}% Space above
   \noindent{#1}%
   \begin{steps}}%\begin{TMachine}
  {\end{steps}%
\vspace{.5\baselineskip\@plus.2\baselineskip\@minus.2\baselineskip}% Space below
}% \end{TMachine}

\newcommand{\accept}{\emph{accept}}
\newcommand{\reject}{\emph{reject}}

\makeatother

\title{Computability and Complexity:\\Exercise Session 7 (2016-11-16)}
\author{Aur√©lien Ooms\footnote{aureooms@ulb.ac.be}}
\date{\today}

\begin{document}
\maketitle
\tableofcontents

\section{3SAT is polynomial-time reducible to 3-COLORING\footnote{%
Exercise 7.29 from the reference book: Sipser M.,
\emph{Introduction to the Theory of Computation}, 3rd edition (2013).
In the second edition of the book, this exercise is Exercise 7.27.}}

\subsection{Introduction}

Let us recall the big picture. We have shown in the first part of the course,
the part about computability, that not all problems can be solved by means of
Turing machines. We made the distinction between decidable and undecidable
problems, the former being the ones we can solve with algorithms, that is,
procedures that eventually terminate.

The second part, that is, the part about complexity, focuses on the resources
it takes to solve decidable problems. We already introduced the classes P and
NP. NP is the class of problems for which there exists a nondeterministic
polynomial-time algorithm. An equivalent definition is to consider the
languages for which all words have at least one corresponding membership
certificate of polynomial size that can be verified using a polynomial-time
algorithm called a verifier. P is the class of problems for which there exists
a deterministic polynomial-time algorithm, that is, algorithms we consider
efficient. By definition P is contained in NP.
However, we do not know whether P is different from NP, that is, whether
deciding is as easy as verifying.

Later on in the lectures, we will define the notion of NP-completeness and show
that, while we (today) cannot answer the question ``P vs. NP'', we can identify
a set of problems, the NP-complete problems, that capture the complexity of all
the problems in NP. This kind of result relies heavily on the notion of
reduction.

\subsection{Definitions}

We already saw that the reducibility of a problem to
another need not rely on similarity between the two problems. It is
possible to prove reducibility results between two \emph{a priori} unrelated problems.
The goal of this exercise is to show you a reduction of an NP-complete
problem to a problem in NP that, at first sight, might not seem intuitive.

Let us begin with a few definitions
\begin{definition}
	A boolean formula \(\phi\) over \(n\) variables \(x_1,x_2,\ldots,x_n\) is in
	conjunctive normal form if \(\phi\) can be
	written as a conjunction of \(m\) clauses \(c_1 \land c_2 \land \cdots \land
	c_m\) where each clause \(c_j\) can be written as a disjunction of
	\(k_j\) literals
	\((l_{j,1} \lor l_{j,2} \lor \cdots \lor l_{j,k_j})\) where each literal is
	either a variable \(x_i\) or the negation of a variable \(\lnot x_i\).
	The language CNF is the language of boolean formulae in conjunctive normal
	form.
\end{definition}

The language CNF-SAT is defined as
\begin{definition}
  CNF-SAT $= \{\, \langle \phi \rangle \st \text{$\phi \in$ CNF and there exists an
  assignment $\in \{0,1\}^n$ on the variables $x_1,x_2,\ldots,x_n$ that
  makes the formula evaluate to true.}\,\}$
\end{definition}

The language 3SAT is a subset of CNF-SAT
\begin{definition}
  3SAT $= \{\,\langle \phi \rangle \st \phi \in \text{CNF-SAT and has
  exactly 3 literals per clause.}\,\}$
\end{definition}

Given a graph, an independent set is a subset of its vertices such that
\textbf{no} pair in this subset is connected by an edge.
\begin{definition}[Independent set]
  Let $G=(V,E)$, $S\subseteq V$. The set of vertices $S$ is an independent set
  of $G$ if and only if for all $(u,v) \in S^2$ with $u\ne v$, $\{\,u,v\,\} \not\in E$.
\end{definition}

Given a graph, we define a proper 3-coloring
\begin{definition}
  Given a graph $G=(V,E)$, a proper 3-coloring of $G$ is a triple of
  independent sets
  $R,G,B\subseteq V$ that are pairwise disjoint, that is, $R\cap G
  =\emptyset,R\cap B=\emptyset,G\cap B =\emptyset$, and such that $R\cup G\cup
  B = V$.
\end{definition}

The language 3-COLORING is the following
\begin{definition}
  3-COLORING $= \{\, \langle G \rangle \st \text{$G$ is a graph and has
  a proper 3-coloring.}\,\}$.
\end{definition}

\subsection{Statement and proof}

We now prove the following
\begin{theorem}
	3SAT \(\le_P\) 3-COLORING
\end{theorem}

\subsubsection{Reduction}

Given a boolean formula \(\phi\) in conjunctive normal form with exactly three
literals per clause, we construct a graph \(G = (V,E)\) and then prove that \(G\)
has a proper 3-coloring of size \(m\), for some $m$ to be determined later,
if and only if \(\phi\) is satisfiable.

We start with an empty graph. For each clause we add \ldots. 

Here is a corresponding \emph{Turing-machine-like} description of the algorithm
\begin{TMachine}{\(f =\) on input \(\langle \phi \rangle\):}
\item[1.] \(V \gets \emptyset\)
\item[2.] \(E \gets \emptyset\)
\item[?.] \ldots
\item[4.] Output \(\langle (V,E) \rangle\)
\end{TMachine}

\subsubsection{Complexity}
An important step when reducing an NP-complete problem to an NP problem is to
check that the reduction takes polynomial time and that the new problem is of
polynomial size.

It is not difficult to see that the complexity of the algorithm above is
\ldots. The size of the output graph
(\(\card{V} + \card{E}\)) is \(O(\ldots)\). \(f\) runs thus in polynomial
time and produces a graph of polynomial size.

\subsubsection{Correctness}

We need to prove that \(\langle \phi \rangle \in \text{3SAT} \iff f(\langle \phi \rangle) \in
\text{3-COLORING}\). We prove the two implications of the equivalence.

\paragraph{(\(\implies\))} If \(\langle\phi\rangle \in \text{3SAT}\) then, by definition,
there exists an assignment \((x_1', x_2', \ldots, x_n') \in \{0,1\}^n\) such
that for each clause there is at least one literal \(l_{j,z_j}\) that evaluates
to true. In other words, \(\exists l_{1,z_1},l_{2,z_2},\ldots,l_{m,z_m}\) such
that no two literals \(l_{a,z_a},l_{b,z_b}\) are contradictory, that is,
\(l_{a,z_a} \neq \lnot l_{b,z_b} \Forall a,b \in [m]\).
%
The corresponding
vertices in the graph \(G\) of \(f(\langle \phi \rangle) = \langle G\rangle\)
can be colored \ldots.
%
Hence, \(f(\langle \phi \rangle) \in \text{3-COLORING}\).

\paragraph{(\(\impliedby\))} If \(f(\langle \phi \rangle) = \langle G
\rangle \in \text{3-COLORING}\),
then, by definition, \(G\) must have a proper 3-coloring. By
construction of \(G\), this 3-coloring must \ldots.
%
Hence, \(\langle \phi \rangle \in\) 3SAT.

\subsection{About Karp reductions}

What we just did is called a Karp reduction. Given two languages \(A\)
and \(B\), an algorithm for deciding \(B\), and a polynomial-time
mapping procedure \(f\) such that
\(a \in A\) if and only if \(f(a) \in B\), we can decide whether \(a \in A\) using
the following algorithm
\begin{TMachine}{On input \(a\):}
\item[1.] Translate instance \(a \in A\) to the corresponding instance \(f(a) \in
	B\) in polynomial time.
\item[2.] Answer the same as the algorithm for \(B\) run on \(f(a)\).
\end{TMachine}
Moreover, if the algorithm for \(B\) runs in polynomial time so does this
algorithm.

\subsection{3-COLORING is NP-complete}

Let us recall the definition of NP-completeness
\begin{definition}
	A language \(B\) is NP-complete if it satisfies two conditions:
	\begin{enumerate}
		\item \(B\) is in NP, and
		\item every \(A\) in NP is polynomial-time reducible to \(B\).
	\end{enumerate}
\end{definition}

In a previous lecture we have seen that
\begin{theorem}
	CNF-SAT is NP-complete
\end{theorem}
and that
\begin{theorem}
	CNF-SAT \(\le_P\) 3SAT.
\end{theorem}
Those two theorems together with the one we just proved and the fact that
3-COLORING is in NP\footnote{Left as exercise for the reader}
imply the following corollary
\begin{corollary}
	3-COLORING is NP-complete.
\end{corollary}
\end{document}
